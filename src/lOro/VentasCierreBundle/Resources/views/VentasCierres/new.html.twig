{% extends '::base.html.twig' %}
{% block title %}Cierres {{ app.request.attributes.get('_route_params')['lugar']  == 'proveedores' ? 'Proveedores' : 'Aupanas / HC'}}{% endblock %}

{% block stylesheets %}
  <style type="text/css">
    #proveedores-form .form-control-feedback {
    right: 17px;
  }
  </style>

{% endblock %}
{% block body -%}

<!-- LLamado del twig con los flash del sistema -->
{% include '::VariosSistema/mensajes_flash.html.twig' %}

<div class="page-header">
  <h1>Cierres {{ app.request.attributes.get('_route_params')['lugar']  == 'proveedores' ? 'Proveedores' : 'Aupanas / HC'}}</h1>
</div>
<div class="col-md-10 col-md-offset-1 contenedor-formularios">

  {{ form_start(form) }}
    
    <div class="form-group">
      <div class="col-xs-9">
      {{ form_label(form.feVenta) }}
      {{ form_widget(form.feVenta) }}
      {{ form_errors(form.feVenta) }}
      </div>
    </div>

    {% if app.request.attributes.get('_route_params')['lugar']  == 'proveedores' %}
      <div class="form-group">
        <div class="col-xs-9">
        {{ form_label(form.dolarReferenciaDia) }}
        {{ form_widget(form.dolarReferenciaDia) }}
        {{ form_errors(form.dolarReferenciaDia) }}
        </div>
      </div>
    {% endif %}
    
    <div class="form-group">
      <div class="col-xs-9">
      {{ form_label(form.tipoMonedaCierre) }}
      {{ form_widget(form.tipoMonedaCierre) }}
      {{ form_errors(form.tipoMonedaCierre) }}
      </div>
            
    
      <div class="col-xs-9">
      {{ form_label(form.cantidadTotalVenta) }}
      {{ form_widget(form.cantidadTotalVenta) }}
      {{ form_errors(form.cantidadTotalVenta) }} 
      </div>

      <div class="col-xs-9">
      {{ form_label(form.valorOnza) }}
      {{ form_widget(form.valorOnza) }}
      {{ form_errors(form.valorOnza) }}  
      </div>
    </div>

    {% if app.request.attributes.get('_route_params')['lugar']  == 'hc' %}
      <div class="form-group">
        <div class="col-xs-9">
        {{ form_label(form.montoTotalDolar) }}
        {{ form_widget(form.montoTotalDolar, { 'attr': { 'readonly': 'true' } }) }}
        {{ form_errors(form.montoTotalDolar) }}  
        </div>
      </div>
    {% endif %}

    {% if app.request.attributes.get('_route_params')['lugar']  == 'proveedores' %}
      <div class="form-group">      
        <div class="col-xs-9">
        {{ form_label(form.montoBsCierrePorGramo) }}
        {{ form_widget(form.montoBsCierrePorGramo) }}
        {{ form_errors(form.montoBsCierrePorGramo) }}
        </div>
      </div>
    {% endif %}

    {% if app.request.attributes.get('_route_params')['lugar']  == 'proveedores' %}
      <div class="form-group">
        <div class="col-xs-9">
        {{ form_label(form.proveedorCierre) }}
        {{ form_widget(form.proveedorCierre) }}
        {{ form_errors(form.proveedorCierre) }}  
        </div>
      </div>
    {% endif %}
    
    <div class="form-group">
      <div class="col-xs-9">
      {{ form_widget(form.submit) }}
      </div>
    </div>

     {{ form_rest(form) }}       
    {{ form_end(form) }}
</div>


{% endblock %}
{% block javascripts %}
  <script>
  var _globales = {
    autoCompleteSupplierInputData: {
      inputName: 'venta-cierre-proveedores',
    },
    formId: 'proveedores-form',
    inputBaseName: "{{ app.request.attributes.get('_route_params')['lugar']  == 'proveedores' ? 'loro_entitybundle_ventascierres_' : 'loro_entitybundle_cierres_hc_'}}",
    arrayOptDatePic: {changeMonth: false, changeYear: false, buttonImageOnly: false, dateFormat: 'dd-mm-yy' },
    margenGanancia: {{ ganancia.tipoMargen }},
    onzaTroyGramos: {{ onzaTroyGramos.valorParametro }},
    place: '{{ app.request.attributes.get('_route_params')['lugar'] }}'
  };
  </script>

  {% javascripts  'assets/self/js/closedDeals/new_forms_misc_functions.js' filter='?uglifyjs2' output='js/compiled/app.js' %}
    <script src="{{ asset_url }}"></script>
  {% endjavascripts %}

  {% if app.request.attributes.get('_route_params')['lugar']  == 'proveedores' %}
    {% javascripts  'assets/self/js/closedDeals/new_supplier_closed_deal_validation.js' filter='?uglifyjs2' output='js/compiled/app.js' %}
      <script src="{{ asset_url }}"></script>
    {% endjavascripts %}
  {% else %}
    {% javascripts  'assets/self/js/closedDeals/new_hc_closed_deal_validation.js'  filter='?uglifyjs2' output='js/compiled/app.js' %}
      <script src="{{ asset_url }}"></script>
    {% endjavascripts %}
  {% endif %}

  <script>
  $(function(){

    if (_globales.place == 'proveedores') {
      $("#loro_entitybundle_ventascierres_proveedorCierre").combobox();
    }

  });
  </script>
{% endblock %}